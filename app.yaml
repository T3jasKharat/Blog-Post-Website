runtime: python39

# 1) Environment variables for Django and Aiven
env_variables:

# 2) Update entrypoint so that, on each instance startup:
#    a) Django runs migrations against Aiven (so tables like auth_user exist)
#    b) Django creates a superuser named "admin" if it doesn’t already exist
#    c) Gunicorn finally starts up normally
#
# If you already ran migrations + createsuperuser locally (or via a one-off), you can shorten this to just:
#    entrypoint: gunicorn my_site.wsgi
#
entrypoint: gunicorn my_site.wsgi

handlers:
  # 3a) Serve anything under /files/... from your 'uploads' directory
  - url: /files
    static_dir: uploads

  # 3b) Serve all collectstatic assets under /static/ from 'staticfiles'
  - url: /static
    static_dir: staticfiles

  # 3c) All other URLs go to Django’s WSGI app
  - url: /.*
    script: auto
